<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of experimentData</title>
  <meta name="keywords" content="experimentData">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html &copy; 2003-2019 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="#">classes</a> &gt; <a href="index.html">dataStructs</a> &gt; experimentData.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for classes/dataStructs&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>experimentData
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>This is a script file. </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="experimentData.html" class="code" title="">experimentData</a>	</li><li><a href="stridedExperimentData.html" class="code" title="">stridedExperimentData</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="experimentData.html" class="code" title="">experimentData</a>	</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function this=experimentData(meta,sub,data)</a></li><li><a href="#_sub2" class="code">function this=set.metaData(this,meta)</a></li><li><a href="#_sub3" class="code">function this=set.subData(this,sub)</a></li><li><a href="#_sub4" class="code">function this=set.data(this,data)</a></li><li><a href="#_sub5" class="code">function a=get.isProcessed(this)</a></li><li><a href="#_sub6" class="code">function a=get.isStepped(this)</a></li><li><a href="#_sub7" class="code">function a=get.isRaw(this)</a></li><li><a href="#_sub8" class="code">function fastLeg=get.fastLeg(this)</a></li><li><a href="#_sub9" class="code">function ageInMonths=getSubjectAgeAtExperimentDate(this)</a></li><li><a href="#_sub10" class="code">function slowLeg=getSlowLeg(this)</a></li><li><a href="#_sub11" class="code">function refLeg=getRefLeg(this)</a></li><li><a href="#_sub12" class="code">function fL=getNonRefLeg(this)</a></li><li><a href="#_sub13" class="code">function processedThis=process(this,eventClass)</a></li><li><a href="#_sub14" class="code">function [allTrialModels,modelScore,badFlag]=extractMarkerModels(this)</a></li><li><a href="#_sub15" class="code">function this=checkMarkerHealth(this,refTrial)</a></li><li><a href="#_sub16" class="code">function this=computeAngles(this)</a></li><li><a href="#_sub17" class="code">function adaptData=makeDataObj(this,filename,experimentalFlag,contraLateralFlag)</a></li><li><a href="#_sub18" class="code">function reducedThis=reduce(this,eventLabels,N)</a></li><li><a href="#_sub19" class="code">function [h,adaptDataObject]=parameterEvolutionPlot(this,field)</a></li><li><a href="#_sub20" class="code">function [h,adaptDataObject]=parameterTimeCourse(this,field)</a></li><li><a href="#_sub21" class="code">function this=recomputeParameters(this,eventClass,initEventSide,parameterClasses)</a></li><li><a href="#_sub22" class="code">function this=flushAndRecomputeParameters(this,eventClass,initEventSide)</a></li><li><a href="#_sub23" class="code">function this=recomputeEvents(this,eventClass,initEventSide)</a></li><li><a href="#_sub24" class="code">function stridedExp=splitIntoStrides(this,refEvent)</a></li><li><a href="#_sub25" class="code">function [stridedField,bad,originalTrial,originalInitTime,events]=getStridedField(this,field,conditions,events)</a></li><li><a href="#_sub26" class="code">function [alignedField,originalTrial,bad]=getAlignedField(this,field,conditions,events,alignmentLengths)</a></li><li><a href="#_sub27" class="code">function conditionIdxs=getConditionIdxsFromName(this,conditionNames)</a></li><li><a href="#_sub28" class="code">function [numStrides,trials,initTimes,endTimes]=getStrideInfo(this,eventClass)</a></li><li><a href="#_sub29" class="code">function adaptData=makeDataObjNew(this,filename,experimentalFlag,contraLateralFlag)</a></li><li><a href="#_sub30" class="code">function this=loadobj(this)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 classdef <a href="experimentData.html" class="code" title="">experimentData</a>
0002     <span class="comment">%experimentData  Contains all information for a single experiment</span>
0003     <span class="comment">%</span>
0004     <span class="comment">%experimentData properties:</span>
0005     <span class="comment">%   metaData - experimentMetaData object</span>
0006     <span class="comment">%   subData - subjectData object</span>
0007     <span class="comment">%   data - cell array of labData objects or any objects which extend</span>
0008     <span class="comment">%          labData</span>
0009     <span class="comment">%   isRaw - returns true if data is an object of the rawLabData class</span>
0010     <span class="comment">%   isProcessed - returns true if data is an object of the processedLabData class</span>
0011     <span class="comment">%   isStepped - returns true if data is an object of the strideData class</span>
0012     <span class="comment">%   fastLeg - computes which blet ('L' or 'R') was the fast belt</span>
0013     <span class="comment">%</span>
0014     <span class="comment">%experimentData Methods:</span>
0015     <span class="comment">%   getSlowLeg - returns leg that was on the slow belt</span>
0016     <span class="comment">%   getRefLeg - returns refrence leg for parameter computations</span>
0017     <span class="comment">%   process - creates a new experimentData object with data property</span>
0018     <span class="comment">%   being a cell of processedLabData objects</span>
0019     <span class="comment">%   makeDataObj - creates an adaptationData object</span>
0020     <span class="comment">%   parameterEvolutionPlot -</span>
0021     <span class="comment">%   parameterTimeCourse -</span>
0022     <span class="comment">%   recomputeParameters -</span>
0023     <span class="comment">%   splitIntoStrides -</span>
0024     <span class="comment">%   getStridedField -</span>
0025     <span class="comment">%   getAlignedField -</span>
0026     <span class="comment">%   getConditionIdxsFromName -</span>
0027     <span class="comment">%</span>
0028     <span class="comment">%See also: experimentMetaData, subjectData, labData</span>
0029 
0030     properties
0031         metaData <span class="comment">% field that contains information from the experiment. Has to be an experimentMetaData object</span>
0032         subData <span class="comment">%subjectData type</span>
0033         data <span class="comment">%cell array of labData type (or its subclasses: rawLabData, processedLabData, strideData), containing data from each trial/ experiment block</span>
0034     <span class="keyword">end</span>
0035 
0036     properties (Dependent)
0037         isRaw <span class="comment">%true if data is an object of the rawLabData class</span>
0038         isProcessed <span class="comment">%true if data is an object of the processedLabData class</span>
0039         isStepped <span class="comment">%or strided</span>
0040         fastLeg
0041     <span class="keyword">end</span>
0042 
0043     methods
0044         <span class="comment">%% Constructor</span>
0045         <a name="_sub0" href="#_subfunctions" class="code">function this=experimentData(meta,sub,data)</a>
0046             <span class="comment">%inputs are metaData, subData, and rawTrialData</span>
0047 
0048            <span class="keyword">if</span> nargin&gt;0
0049                this.metaData=meta;
0050            <span class="keyword">end</span>
0051            <span class="keyword">if</span> nargin&gt;1
0052                this.subData=sub;
0053            <span class="keyword">end</span>
0054            <span class="keyword">if</span> nargin&gt;2
0055                this.data=data;
0056            <span class="keyword">end</span>
0057         <span class="keyword">end</span>
0058 
0059         <span class="comment">%% Setters for class properties</span>
0060         <a name="_sub1" href="#_subfunctions" class="code">function this=set.metaData(this,meta)</a>
0061             <span class="comment">%define or re-define metaData for this experiment</span>
0062             <span class="comment">%</span>
0063             <span class="comment">%INPUT: metaData object</span>
0064             <span class="keyword">if</span> isa(meta,<span class="string">'experimentMetaData'</span>)
0065                this.metaData=meta;
0066            <span class="keyword">else</span>
0067                ME=MException(<span class="string">'experimentData:Constructor'</span>,<span class="string">'Experiment metaData is not an experimentMetaData type object.'</span>);
0068                throw(ME);
0069            <span class="keyword">end</span>
0070         <span class="keyword">end</span>
0071         <a name="_sub2" href="#_subfunctions" class="code">function this=set.subData(this,sub)</a>
0072             <span class="comment">%define or re-define subjectData</span>
0073             <span class="comment">%</span>
0074             <span class="comment">%INPUT: subjectData object</span>
0075             <span class="keyword">if</span> isa(sub,<span class="string">'subjectData'</span>)
0076                this.subData=sub;
0077            <span class="keyword">else</span>
0078                ME=MException(<span class="string">'experimentData:Constructor'</span>,<span class="string">'Subject data is not a subjectData type object.'</span>);
0079                throw(ME);
0080             <span class="keyword">end</span>
0081         <span class="keyword">end</span>
0082         <a name="_sub3" href="#_subfunctions" class="code">function this=set.data(this,data)</a>
0083             <span class="comment">%define or redefine experiment data</span>
0084             <span class="comment">%</span>
0085             <span class="comment">%INPUT: labData object or one of its subclasses</span>
0086             <span class="keyword">if</span> isa(data,<span class="string">'cell'</span>)  <span class="comment">% Has to be array of labData type cells.</span>
0087                aux=find(cellfun(<span class="string">'isempty'</span>,data)~=1);
0088                <span class="keyword">for</span> i=1:length(aux)
0089                    <span class="keyword">if</span> ~isa(data{aux(i)},<span class="string">'labData'</span>) &amp;&amp; ~isa(data{aux(i)},<span class="string">'reducedLabData'</span>)
0090                        ME=MException(<span class="string">'experimentData:Constructor'</span>,<span class="string">'Data is not a cell array of labData (or one of its subclasses) objects.'</span>);
0091                        throw(ME);
0092                    <span class="keyword">end</span>
0093                <span class="keyword">end</span>
0094                this.data=data;
0095            <span class="keyword">else</span>
0096                ME=MException(<span class="string">'experimentData:Constructor'</span>,<span class="string">'Data is not a cell array.'</span>);
0097                throw(ME);
0098             <span class="keyword">end</span>
0099         <span class="keyword">end</span>
0100 
0101         <span class="comment">%% Getters for Dependent properties</span>
0102         <a name="_sub4" href="#_subfunctions" class="code">function a=get.isProcessed(this)</a>
0103             <span class="comment">%Returns true if the trials have been processed (i.e. parameters have been calculated through ladData.process()), and false if</span>
0104             <span class="comment">%they contain only rawData.</span>
0105             <span class="comment">%   INPUTS:</span>
0106             <span class="comment">%       this: experimentData object</span>
0107             <span class="comment">%   OUTPUTS:</span>
0108             <span class="comment">%       a: boolean</span>
0109             aux=cellfun(<span class="string">'isempty'</span>,this.data);
0110             idx=find(aux~=1); <span class="comment">%Not empty</span>
0111             a=true;
0112             <span class="keyword">for</span> i=idx
0113                <span class="keyword">if</span> ~isa(this.data{i},<span class="string">'processedLabData'</span>)
0114                    a=false;
0115                <span class="keyword">end</span>
0116             <span class="keyword">end</span>
0117         <span class="keyword">end</span>
0118 
0119         <a name="_sub5" href="#_subfunctions" class="code">function a=get.isStepped(this)</a>
0120             <span class="comment">%returns true if data is an object of the strideData class</span>
0121             aux=cellfun(<span class="string">'isempty'</span>,this.data);
0122             idx=find(aux~=1,1);
0123             a=isa(this.data{idx},<span class="string">'strideData'</span>);
0124         <span class="keyword">end</span>
0125 
0126         <a name="_sub6" href="#_subfunctions" class="code">function a=get.isRaw(this)</a>
0127             <span class="comment">%returns true if data is an object of the rawLabData class</span>
0128             aux=cellfun(<span class="string">'isempty'</span>,this.data);
0129             idx=find(aux~=1,1);
0130             a=isa(this.data{idx},<span class="string">'rawLabData'</span>);
0131         <span class="keyword">end</span>
0132 
0133         <a name="_sub7" href="#_subfunctions" class="code">function fastLeg=get.fastLeg(this)</a>
0134             error(<span class="string">'Unimplemented. Try getRefLeg, which reads slow/fast leg labels from trial metaData.'</span>)
0135             <span class="comment">%based on each trial, determine from the data (not metadata which could be wrong) which leg is the fast leg, even</span>
0136             <span class="comment">%if there is no belt data</span>
0137             <span class="comment">%</span>
0138             <span class="comment">%returns 'R' or 'L'</span>
0139             vR=[];
0140             vL=[];
0141             trials=cell2mat(this.metaData.trialsInCondition);
0142             <span class="keyword">for</span> i=1:length(trials)
0143                 trial=trials(i);
0144                 <span class="keyword">if</span> ~this.isStepped
0145                     <span class="keyword">if</span> ~isempty(this.data{trial}.beltSpeedReadData)
0146                         <span class="comment">%Old version: Need to fix, as</span>
0147                         <span class="comment">%we are not really populating the beltSpeedReadData</span>
0148                         <span class="comment">%field.</span>
0149                         <span class="comment">%vR(end+1)=nanmean(this.data{trial}.beltSpeedReadData.getDataAsVector('R'));</span>
0150                         <span class="comment">%vL(end+1)=nanmean(this.data{trial}.beltSpeedReadData.getDataAsVector('L'));</span>
0151                         <span class="comment">%New version:</span>
0152                         <span class="comment">%TODO: Need to come up with an appropriate velocity</span>
0153                         <span class="comment">%measurement if we want this function to work</span>
0154                         <span class="comment">%properly.</span>
0155                     <span class="keyword">end</span>
0156                 <span class="keyword">else</span> <span class="comment">%Stepped trial</span>
0157                     <span class="keyword">for</span> step=1:length(this.data{trial})
0158                         <span class="keyword">if</span> ~isempty(this.data{trial}{step}.beltSpeedReadData)
0159                             <span class="comment">%vR(end+1)=nanmean(this.data{trial}{step}.beltSpeedReadData.getDataAsVector('R'));</span>
0160                             <span class="comment">%vL(end+1)=nanmean(this.data{trial}{step}.beltSpeedReadData.getDataAsVector('L'));</span>
0161                         <span class="keyword">end</span>
0162                     <span class="keyword">end</span>
0163                 <span class="keyword">end</span>
0164             <span class="keyword">end</span>
0165             <span class="keyword">if</span> ~isempty(vR) &amp;&amp; ~isempty(vL)
0166                 <span class="keyword">if</span> nanmean(vR)&lt;nanmean(vL)
0167                     fastLeg=<span class="string">'L'</span>;
0168                 <span class="keyword">elseif</span> nanmean(vR)&gt;nanmean(vL)
0169                     fastLeg=<span class="string">'R'</span>; <span class="comment">%Defaults to this, even if there is no beltSpeedData</span>
0170                 <span class="keyword">else</span>
0171                     error(<span class="string">'experimentData:fastLeg'</span>,<span class="string">'Both legs are moving at the same speed'</span>);
0172                 <span class="keyword">end</span>
0173             <span class="keyword">else</span>
0174                 error(<span class="string">'experimentData:fastLeg'</span>,<span class="string">'No data to compute fastest leg, try using expData.getRefLeg which reads from each trial''s metaData.'</span>);
0175             <span class="keyword">end</span>
0176         <span class="keyword">end</span>
0177 
0178         <a name="_sub8" href="#_subfunctions" class="code">function ageInMonths=getSubjectAgeAtExperimentDate(this)</a>
0179             <span class="keyword">if</span> ~isempty(this.subData.age)
0180                 ageInMonths=this.subData.age*12; <span class="comment">%In months</span>
0181             <span class="keyword">elseif</span> ~isempty(this.subData.dateOfBirth)
0182                 warning(<span class="string">'expData:subjectDOB'</span>,<span class="string">'subject metadata contains DOB, this may be a privacy issue.'</span>)
0183                 dob=this.subData.dateOfBirth;
0184                 testData=this.metaData.date;
0185                 [ageInMonths]=testData.timeSince(dob);
0186             <span class="keyword">else</span>
0187                 error(<span class="string">'expData:subjectDOB'</span>,<span class="string">'Could not establish subject age at experiment time.'</span>)
0188             <span class="keyword">end</span>
0189         <span class="keyword">end</span>
0190 
0191         <a name="_sub9" href="#_subfunctions" class="code">function slowLeg=getSlowLeg(this)</a>
0192             <span class="comment">%determine which leg is the slow leg, simply the opposite of</span>
0193             <span class="comment">%the fast leg, be sure to call get.fastLeg() first</span>
0194             <span class="comment">%</span>
0195             <span class="comment">%returns 'R' or 'L'</span>
0196             <span class="keyword">if</span> strcmpi(this.fastLeg,<span class="string">'L'</span>)
0197                 slowLeg=<span class="string">'R'</span>;
0198             <span class="keyword">elseif</span> strcmpi(this.fastLeg,<span class="string">'R'</span>)
0199                 slowLeg=<span class="string">'L'</span>;
0200             <span class="keyword">else</span>
0201                 slowLeg=[];
0202             <span class="keyword">end</span>
0203         <span class="keyword">end</span>
0204 
0205         <a name="_sub10" href="#_subfunctions" class="code">function refLeg=getRefLeg(this)</a>
0206             <span class="comment">%By majority vote over trials, returns the reference leg for</span>
0207             <span class="comment">%the entire experiment</span>
0208             <span class="comment">%</span>
0209             <span class="comment">%returns 'R' or 'L'</span>
0210             refLeg={};
0211            <span class="keyword">for</span> i=1:length(this.data)<span class="comment">%Going over trials</span>
0212                <span class="keyword">if</span> ~isempty(this.data{i})
0213                refLeg{i}=this.data{i}.metaData.refLeg;
0214                <span class="keyword">end</span>
0215            <span class="keyword">end</span>
0216            Rvotes=sum(strcmp(refLeg,<span class="string">'R'</span>));
0217            Lvotes=sum(strcmp(refLeg,<span class="string">'L'</span>));
0218            <span class="keyword">if</span> Rvotes&gt;Lvotes
0219                refLeg=<span class="string">'R'</span>;
0220            <span class="keyword">elseif</span> Rvotes&lt;Lvotes
0221                refLeg=<span class="string">'L'</span>;
0222            <span class="keyword">else</span>
0223                error(<span class="string">'experimentData:getRefLeg'</span>,<span class="string">'Could not determine unique reference leg'</span>);
0224            <span class="keyword">end</span>
0225         <span class="keyword">end</span>
0226 
0227         <a name="_sub11" href="#_subfunctions" class="code">function fL=getNonRefLeg(this)</a>
0228             <span class="comment">%returns the non-reference leg, 'R' or 'L'</span>
0229             sL=this.getRefLeg;
0230             <span class="keyword">if</span> strcmp(sL,<span class="string">'R'</span>)
0231                 fL=<span class="string">'L'</span>;
0232             <span class="keyword">else</span>
0233                 fL=<span class="string">'R'</span>;
0234             <span class="keyword">end</span>
0235         <span class="keyword">end</span>
0236 
0237         <span class="comment">%% processing</span>
0238         <a name="_sub12" href="#_subfunctions" class="code">function processedThis=process(this,eventClass)</a>
0239 
0240         <span class="keyword">if</span> nargin&lt;2 || isempty(eventClass)
0241             eventClass=[];
0242         <span class="keyword">end</span>
0243         <span class="comment">%process  process full experiment</span>
0244         <span class="comment">%</span>
0245         <span class="comment">%Returns a new experimentData object with same metaData, subData and processed (trial) data.</span>
0246         <span class="comment">%This is done by iterating through data (trials) and</span>
0247         <span class="comment">%processing each by using labData.process</span>
0248         <span class="comment">%ex: expData=rawExpData.process</span>
0249         <span class="comment">%</span>
0250         <span class="comment">%INPUTS:</span>
0251         <span class="comment">%this: experimentData object</span>
0252         <span class="comment">%</span>
0253         <span class="comment">%OUTPUTS:</span>
0254         <span class="comment">%processedThis: experimentData object with processed data</span>
0255         <span class="comment">%</span>
0256         <span class="comment">%See also: labData</span>
0257 
0258             <span class="keyword">for</span> trial=1:length(this.data)
0259                 disp([<span class="string">'Processing trial '</span> num2str(trial) <span class="string">'...'</span>])
0260                 <span class="keyword">if</span> ~isempty(this.data{trial})
0261                     procData{trial}=this.data{trial}.process(this.subData,eventClass);
0262                 <span class="keyword">else</span>
0263                    procData{trial}=[];
0264                 <span class="keyword">end</span>
0265             <span class="keyword">end</span>
0266             <span class="comment">%this=checkMarkerHealth(this);</span>
0267             processedThis=<a href="experimentData.html" class="code" title="">experimentData</a>(this.metaData,this.subData,procData);
0268         <span class="keyword">end</span>
0269 
0270         <a name="_sub13" href="#_subfunctions" class="code">function [allTrialModels,modelScore,badFlag]=extractMarkerModels(this)</a>
0271             noFixFlag=false; <span class="comment">%This flag will prevent trying to find permutations to fix data, which can be slow.</span>
0272             <span class="comment">%First: build models</span>
0273             m=cell(length(this.data),1);
0274             badFlag=false(size(m));
0275             modelScore=nan(size(m));
0276             modelScore2=nan(size(m));
0277             permuteList=[];
0278             <span class="keyword">for</span> trial=1:length(this.data)
0279                 <span class="keyword">if</span> ~isempty(this.data{trial})
0280                     aux=this.data{trial}.markerData;
0281                     [aux,m{trial},permuteList,modelScore(trial),badFlag(trial),modelScore2(trial)]=aux.fixBadLabels(permuteList);
0282                 <span class="keyword">end</span>
0283             <span class="keyword">end</span>
0284             allTrialModels=m;
0285         <span class="keyword">end</span>
0286 
0287         <a name="_sub14" href="#_subfunctions" class="code">function this=checkMarkerHealth(this,refTrial)</a>
0288             disp([<span class="string">'Checking marker health...'</span>])
0289 
0290             <span class="comment">%First: build models</span>
0291             [allTrialModels,modelScore,badFlag]=<a href="#_sub14" class="code" title="subfunction [allTrialModels,modelScore,badFlag]=extractMarkerModels(this)">extractMarkerModels</a>(this);
0292 
0293             <span class="comment">%Second: select best model</span>
0294             <span class="comment">%TODO: move this chunk to its own function?</span>
0295             noOutlierTest=false;
0296             <span class="keyword">if</span> (nargin&lt;2 || isempty(refTrial)) &amp;&amp; ~all(badFlag)
0297                 modelScore(badFlag)=Inf;
0298                 [~,refTrial]=nanmin(modelScore);
0299             <span class="keyword">elseif</span> all(badFlag) <span class="comment">%Undefined refTrial but all trials are bad</span>
0300                  warning(<span class="string">'Could not find suitable data for model training. Not testing for outliers.'</span>)
0301                  noOutlierTest=true; <span class="comment">%This flag prevents the testing for outliers later on.</span>
0302             <span class="keyword">end</span>
0303             <span class="keyword">try</span> <span class="comment">%If there is a model</span>
0304                 mm=allTrialModels{refTrial};
0305                 fprintf([<span class="string">'Using trial '</span> num2str(refTrial) <span class="string">' to train outlier detection model...\n'</span>])
0306                 mm.seeModel;
0307             <span class="keyword">catch</span>
0308                 <span class="comment">%nop</span>
0309             <span class="keyword">end</span>
0310 
0311             <span class="comment">%Third: for each trial, get  missing markers, analyze fitted model and  find outliers through best model</span>
0312             <span class="keyword">for</span> trial=1:length(this.data)
0313                 disp([<span class="string">'Checking trial '</span> num2str(trial) <span class="string">'...'</span>])
0314                 <span class="keyword">if</span> ~isempty(this.data{trial})
0315                     aux=this.data{trial}.markerData;
0316 
0317                     <span class="comment">%A: check missing data &amp; fill gaps</span>
0318                     [~,~,missing]=aux.assessMissing([],-1);
0319 
0320                     <span class="comment">%B: analyze fitted models.</span>
0321                     [~]=validateMarkerModel(allTrialModels{trial},true);
0322 
0323                     <span class="comment">%C: find outliers</span>
0324                     <span class="keyword">if</span> ~noOutlierTest
0325                         aux=aux.findOutliers(mm,true);
0326                         this.data{trial}.markerData=aux;
0327                     <span class="keyword">end</span>
0328                 <span class="keyword">end</span>
0329             <span class="keyword">end</span>
0330             disp([<span class="string">'Outlier data added in Quality field'</span>]);
0331         <span class="keyword">end</span>
0332 
0333 
0334          <a name="_sub15" href="#_subfunctions" class="code">function this=computeAngles(this)</a><span class="comment">%added by Digna</span>
0335             <span class="keyword">for</span> trial=1:length(this.data)
0336                 disp([<span class="string">'Computing angles for trial '</span> num2str(trial) <span class="string">'...'</span>])
0337                 <span class="keyword">if</span> ~isempty(this.data{trial})
0338                     this.data{trial}.angleData=this.data{trial}.calcLimbAngles;
0339                 <span class="keyword">else</span>
0340 
0341                 <span class="keyword">end</span>
0342             <span class="keyword">end</span>
0343        <span class="keyword">end</span>
0344 
0345         <a name="_sub16" href="#_subfunctions" class="code">function adaptData=makeDataObj(this,filename,experimentalFlag,contraLateralFlag)</a>
0346         <span class="comment">%MAKEDATAOBJ  creates an object of the adaptationData class.</span>
0347         <span class="comment">%   adaptData=expData.makeDataObj(filename,experimentalFlag)</span>
0348         <span class="comment">%</span>
0349         <span class="comment">%INPUTS:</span>
0350         <span class="comment">%this: experimentData object</span>
0351         <span class="comment">%filename: string (typically subject identifier)</span>
0352         <span class="comment">%experimentalFlag: boolean - false (or 0) prevents experimental</span>
0353         <span class="comment">%parameter calculation and inclusion</span>
0354         <span class="comment">%</span>
0355         <span class="comment">%OUTPUTS:</span>
0356         <span class="comment">%adptData: object if the adaptationData class, which is</span>
0357         <span class="comment">%saved to present working directory if a filename is specified.</span>
0358         <span class="comment">%</span>
0359         <span class="comment">%   Examples:</span>
0360         <span class="comment">%</span>
0361         <span class="comment">%   adaptData=expData.makeDataObj('Sub01') saves adaptationData</span>
0362         <span class="comment">%   object to Sub01params.mat</span>
0363         <span class="comment">%</span>
0364         <span class="comment">%   adaptData=expData.makeDataObj('',false) does not include</span>
0365         <span class="comment">%   experimentalParams in adaptData object and does not save to file</span>
0366         <span class="comment">%</span>
0367         <span class="comment">%See also: adaptationData, paramData</span>
0368             <span class="keyword">if</span> ~(this.isProcessed)
0369                 ME=MException(<span class="string">'experimentData:makeDataObj'</span>,<span class="string">'Cannot create an adaptationData object from unprocessed data!'</span>);
0370                 throw(ME);
0371             <span class="keyword">end</span>
0372 
0373             <span class="keyword">if</span> nargin&lt;3
0374                 experimentalFlag=[];
0375             <span class="keyword">end</span>
0376             <span class="keyword">if</span> nargin&lt;2
0377                 filename=[];
0378             <span class="keyword">end</span>
0379             <span class="keyword">if</span> nargin&lt;4
0380                 contraLateralFlag=[];
0381             <span class="keyword">end</span>
0382             adaptData=<a href="#_sub29" class="code" title="subfunction adaptData=makeDataObjNew(this,filename,experimentalFlag,contraLateralFlag)">makeDataObjNew</a>(this,filename,experimentalFlag,contraLateralFlag);
0383         <span class="keyword">end</span>
0384 
0385         <a name="_sub17" href="#_subfunctions" class="code">function reducedThis=reduce(this,eventLabels,N)</a>
0386             <span class="keyword">if</span> nargin&lt;2 || isempty(eventLabels)
0387                 s=this.getRefLeg;
0388                 f=this.getNonRefLeg;
0389                 eventLabels={[s,<span class="string">'HS'</span>],[f,<span class="string">'TO'</span>],[f,<span class="string">'HS'</span>],[s,<span class="string">'TO'</span>]};
0390             <span class="keyword">end</span>
0391             <span class="keyword">if</span> nargin&lt;3
0392                 N=[];
0393             <span class="keyword">end</span>
0394             redData=cell(size(this.data));
0395             <span class="keyword">for</span> i=1:length(this.data)
0396                 redData{i}=this.data{i}.reduce(eventLabels,N);
0397             <span class="keyword">end</span>
0398             reducedThis=<a href="experimentData.html" class="code" title="">experimentData</a>(this.metaData,this.subData,redData);
0399         <span class="keyword">end</span>
0400 
0401 
0402         <span class="comment">%% Display</span>
0403         <span class="comment">%HH: I don't like either of these functions. They take way too long</span>
0404         <span class="comment">%to run, and at the time being they assume that if a field isn't a</span>
0405         <span class="comment">%label of the adaptParams property, then it must be a label of</span>
0406         <span class="comment">%experimentalParams (which is a bad assumption becasue it could</span>
0407         <span class="comment">%result in 5+ minutes of waiting just to find out the parameter</span>
0408         <span class="comment">%doesn't exist.)</span>
0409         <span class="comment">%PI, 5/26/2015: Agreed. Is there any other way to do it if someone asks for a</span>
0410         <span class="comment">%label that does not exist? Do note that these functions are here</span>
0411         <span class="comment">%for flexibility of the code, but the really efficient way to do it</span>
0412         <span class="comment">%is generate an adaptData object (and save it) and use its plotting</span>
0413         <span class="comment">%functions (which is what these do). Perhaps we could issue a</span>
0414         <span class="comment">%warning or a disclaimer telling the user that this takes TOO long.</span>
0415         <a name="_sub18" href="#_subfunctions" class="code">function [h,adaptDataObject]=parameterEvolutionPlot(this,field)</a>
0416             <span class="comment">%???</span>
0417             <span class="comment">%</span>
0418             <span class="comment">%INPUTS:</span>
0419             <span class="comment">%field,</span>
0420             <span class="keyword">if</span> ~(this.isProcessed)
0421                 ME=MException(<span class="string">'experimentData:parameterEvolutionPlot'</span>,<span class="string">'Cannot generate parameter evolution plot from unprocessed data!'</span>);
0422                 throw(ME);
0423             <span class="keyword">end</span>
0424             <span class="keyword">if</span> ~isempty(this.data{1}) &amp;&amp; (all(this.data{1}.adaptParams.isaLabel(field)))
0425                 adaptDataObject=this.makeDataObj([],0);
0426                 h=adaptDataObject.plotParamByConditions(field);
0427             <span class="keyword">else</span>
0428                 adaptDataObject=this.makeDataObj; <span class="comment">%Creating adaptationData object, to include experimentalParams (which are Dependent and need to be computed each time). Otherwise we could just access this.data{trial}.experimentalParams</span>
0429                 h=adaptDataObject.plotParamByConditions(field);
0430             <span class="keyword">end</span>
0431         <span class="keyword">end</span>
0432 
0433         <a name="_sub19" href="#_subfunctions" class="code">function [h,adaptDataObject]=parameterTimeCourse(this,field)</a>
0434             <span class="keyword">if</span> ~(this.isProcessed)
0435                 ME=MException(<span class="string">'experimentData:parameterTimeCourse'</span>,<span class="string">'Cannot generate parameter time course plot from unprocessed data!'</span>);
0436                 throw(ME);
0437             <span class="keyword">end</span>
0438             <span class="keyword">if</span> ~isempty(this.data{1}) &amp;&amp; (all(this.data{1}.adaptParams.isaLabel(field)))
0439                 adaptDataObject=this.makeDataObj([],0);
0440                 h=adaptDataObject.plotParamTimeCourse(field);
0441             <span class="keyword">else</span>
0442                 adaptDataObject=this.makeDataObj; <span class="comment">%Creating adaptationData object, to include experimentalParams (which are Dependent and need to be computed each time). Otherwise we could just access this.data{trial}.experimentalParams</span>
0443                 h=adaptDataObject.plotParamTimeCourse(field);
0444             <span class="keyword">end</span>
0445         <span class="keyword">end</span>
0446 
0447         <span class="comment">%% Update/modify</span>
0448         <a name="_sub20" href="#_subfunctions" class="code">function this=recomputeParameters(this,eventClass,initEventSide,parameterClasses)</a>
0449         <span class="comment">%RECOMPUTEPARAMETERS recomputes adaptParams for all labData</span>
0450         <span class="comment">%objects in experimentData.data.</span>
0451         <span class="comment">%</span>
0452         <span class="comment">%   Example: if expData is an object of the experimentalData class,</span>
0453         <span class="comment">%       expData=expData.recomputeParameters</span>
0454         <span class="comment">%   will recompute expData.data{i}.adaptParams for all i where</span>
0455         <span class="comment">%   i is a trial of the experiment</span>
0456         <span class="comment">%</span>
0457         <span class="comment">%   See also: parameterSeries</span>
0458             <span class="keyword">if</span> nargin&lt;2 || isempty(eventClass)
0459                 eventClass=[];
0460             <span class="keyword">end</span>
0461             <span class="keyword">if</span> nargin&lt;3 || isempty(initEventSide)
0462                 initEventSide=[];
0463             <span class="keyword">end</span>
0464             <span class="keyword">if</span> nargin&lt;4 || isempty(parameterClasses)
0465                 parameterClasses=[];
0466             <span class="keyword">end</span>
0467             trials=cell2mat(this.metaData.trialsInCondition);
0468             <span class="keyword">for</span> t=trials
0469                   newParams=calcParameters(this.data{t},this.subData,eventClass,initEventSide,parameterClasses);
0470                   this.data{t}.adaptParams=this.data{t}.adaptParams.replaceParams(newParams);
0471             <span class="keyword">end</span>
0472         <span class="keyword">end</span>
0473 
0474         <a name="_sub21" href="#_subfunctions" class="code">function this=flushAndRecomputeParameters(this,eventClass,initEventSide)</a>
0475         <span class="comment">%FLUSHANDRECOMPUTEPARAMETERS recomputes adaptParams for all labData</span>
0476         <span class="comment">%objects in experimentData.data</span>
0477         <span class="comment">%Different from recomputeParameters() it throws away the previously</span>
0478         <span class="comment">%existing parameters [recompute only substitutes IF there are name</span>
0479         <span class="comment">%collisions, so it allows for recomputing only force or EMG params]</span>
0480         <span class="comment">%</span>
0481         <span class="comment">%   Example: if expData is an object of the experimentalData class,</span>
0482         <span class="comment">%       expData=expData.recomputeParameters</span>
0483         <span class="comment">%   will recompute expData.data{i}.adaptParams for all i where</span>
0484         <span class="comment">%   i is a trial of the experiment</span>
0485         <span class="comment">%</span>
0486         <span class="comment">%   See also: parameterSeries</span>
0487             <span class="keyword">if</span> nargin&lt;2 || isempty(eventClass)
0488                 eventClass=[];
0489             <span class="keyword">end</span>
0490             <span class="keyword">if</span> nargin&lt;3 || isempty(initEventSide)
0491                 initEventSide=[];
0492             <span class="keyword">end</span>
0493             trials=cell2mat(this.metaData.trialsInCondition);
0494             <span class="keyword">for</span> t=trials
0495                   this.data{t}.adaptParams=calcParameters(this.data{t},this.subData,eventClass,initEventSide,[]);
0496             <span class="keyword">end</span>
0497         <span class="keyword">end</span>
0498 
0499         <a name="_sub22" href="#_subfunctions" class="code">function this=recomputeEvents(this,eventClass,initEventSide)</a>
0500         <span class="comment">%RECOMPUTEEVENTS recomputes events AND parameters for all trials,</span>
0501         <span class="comment">%with default options.</span>
0502         <span class="comment">%See also: processedLabData.recomputeEvents</span>
0503             trials=cell2mat(this.metaData.trialsInCondition);
0504             <span class="keyword">for</span> t=trials
0505                   this.data{t}=<a href="#_sub23" class="code" title="subfunction this=recomputeEvents(this,eventClass,initEventSide)">recomputeEvents</a>(this.data{t}); <span class="comment">%This recomputes events AND recomputes parameters (otherwise parameters will not correspond to the new events)</span>
0506             <span class="keyword">end</span>
0507         <span class="keyword">end</span>
0508 
0509         <a name="_sub23" href="#_subfunctions" class="code">function stridedExp=splitIntoStrides(this,refEvent)</a>
0510         <span class="comment">%This might not be used?</span>
0511             <span class="keyword">if</span> ~this.isStepped &amp;&amp; this.isProcessed
0512                 <span class="keyword">for</span> trial=1:length(this.data)
0513                     disp([<span class="string">'Splitting trial '</span> num2str(trial) <span class="string">'...'</span>])
0514                     trialData=this.data{trial};
0515                     <span class="keyword">if</span> ~isempty(trialData)
0516                         <span class="keyword">if</span> nargin&lt;2 || isempty(refEvent)
0517                             refEvent=[trialData.metaData.refLeg,<span class="string">'HS'</span>];
0518                             <span class="comment">%Assuming that the first event of each stride should be</span>
0519                             <span class="comment">%the heel strike of the refLeg! (check c3d2mat -</span>
0520                             <span class="comment">%refleg should be opposite the dominant/fast leg)</span>
0521                         <span class="keyword">end</span>
0522                         aux=trialData.separateIntoStrides(refEvent);
0523                         strides{trial}=aux;
0524                     <span class="keyword">else</span>
0525                         strides{trial}=[];
0526                     <span class="keyword">end</span>
0527                 <span class="keyword">end</span>
0528                 stridedExp=<a href="stridedExperimentData.html" class="code" title="">stridedExperimentData</a>(this.metaData,this.subData,strides);
0529             <span class="keyword">else</span>
0530                 disp(<span class="string">'Cannot stride experiment because it is raw or already strided.'</span>);
0531             <span class="keyword">end</span>
0532         <span class="keyword">end</span>
0533 
0534         <a name="_sub24" href="#_subfunctions" class="code">function [stridedField,bad,originalTrial,originalInitTime,events]=getStridedField(this,field,conditions,events)</a>
0535             <span class="keyword">if</span> nargin&lt;4 || isempty(events)
0536                 events=[this.getSlowLeg <span class="string">'HS'</span>];
0537             <span class="keyword">end</span>
0538            <span class="keyword">if</span> nargin&lt;3 || isempty(conditions)
0539                trials=cell2mat(this.metaData.trialsInCondition);
0540            <span class="keyword">else</span>
0541                <span class="keyword">if</span> ~isa(conditions,<span class="string">'double'</span>) <span class="comment">%If conditions are given by name, and not by index</span>
0542                    conditions=<a href="#_sub27" class="code" title="subfunction conditionIdxs=getConditionIdxsFromName(this,conditionNames)">getConditionIdxsFromName</a>(this,conditions);
0543                <span class="keyword">end</span>
0544                trials=cell2mat(this.metaData.trialsInCondition(conditions));
0545            <span class="keyword">end</span>
0546            stridedField={};
0547            bad=[];
0548            originalInitTime=[];
0549            originalTrial=[];
0550            <span class="keyword">for</span> i=trials
0551               <span class="comment">%[aux,bad1,initTime1]=this.data{i}.(field).splitByEvents(this.data{i}.gaitEvents,events);</span>
0552               [aux,bad1,initTime1,events]=this.data{i}.getStridedField(field,events);
0553               stridedField=[stridedField; aux];
0554               bad=[bad; bad1];
0555               originalTrial=[originalTrial; i*ones(size(bad1))];
0556               originalInitTime=[originalInitTime; initTime1];
0557            <span class="keyword">end</span>
0558         <span class="keyword">end</span>
0559 
0560         <a name="_sub25" href="#_subfunctions" class="code">function [alignedField,originalTrial,bad]=getAlignedField(this,field,conditions,events,alignmentLengths)</a>
0561            <span class="keyword">if</span> nargin&lt;4 || isempty(events)
0562                events=[this.getSlowLeg <span class="string">'HS'</span>];
0563            <span class="keyword">end</span>
0564            <span class="keyword">if</span> nargin&lt;3 || isempty(conditions)
0565                trials=cell2mat(this.metaData.trialsInCondition);
0566            <span class="keyword">else</span>
0567                <span class="keyword">if</span> ~isa(conditions,<span class="string">'double'</span>) <span class="comment">%If conditions are given by name, and not by index</span>
0568                    conditions=<a href="#_sub27" class="code" title="subfunction conditionIdxs=getConditionIdxsFromName(this,conditionNames)">getConditionIdxsFromName</a>(this,conditions);
0569                <span class="keyword">end</span>
0570                trials=cell2mat(this.metaData.trialsInCondition(conditions));
0571            <span class="keyword">end</span>
0572            bad=[];
0573            originalInitTime=[];
0574            originalTrial=[];
0575            originalDurations=[];
0576            <span class="keyword">for</span> i=trials <span class="comment">%Trials in condition</span>
0577               <span class="comment">%[aux,bad1,initTime1]=this.data{i}.(field).splitByEvents(this.data{i}.gaitEvents,events);</span>
0578               [alignedField1,bad1]=this.data{i}.getAlignedField(field,events,alignmentLengths);
0579               <span class="keyword">if</span> i==trials(1)
0580                   alignedField=alignedField1;
0581               <span class="keyword">else</span>
0582                   force=false;
0583                   alignedField=alignedField.cat(alignedField1,[],force);
0584               <span class="keyword">end</span>
0585               bad=[bad; bad1];
0586               originalTrial=[originalTrial; i*ones(size(bad1))];
0587               <span class="comment">%originalInitTime=[originalInitTime; initTime1];</span>
0588               <span class="comment">%originalDurations=[originalDurations; originalDurations1];</span>
0589            <span class="keyword">end</span>
0590         <span class="keyword">end</span>
0591 
0592         <span class="comment">%% Auxiliar</span>
0593         <a name="_sub26" href="#_subfunctions" class="code">function conditionIdxs=getConditionIdxsFromName(this,conditionNames)</a>
0594             <span class="comment">%Looks for condition names that are similar to the ones given</span>
0595             <span class="comment">%in conditionNames and returns the corresponding condition idx</span>
0596             <span class="comment">%ConditionNames should be a cell array containing a string or</span>
0597             <span class="comment">%another cell array of strings in each of its cells.</span>
0598             <span class="comment">%E.g. conditionNames={'Base','Adap',{'Post','wash'}}</span>
0599             conditionIdxs=this.metaData.getConditionIdxsFromName(conditionNames);
0600         <span class="keyword">end</span>
0601 
0602         <a name="_sub27" href="#_subfunctions" class="code">function [numStrides,trials,initTimes,endTimes]=getStrideInfo(this,eventClass)</a>
0603             numStrides=0;
0604             initTimes=[];
0605             endTimes=[];
0606             trials=[];
0607             <span class="keyword">for</span> t=1:length(this.data)
0608                 <span class="keyword">if</span> ~isempty(this.data{t})
0609                 [numStrides_,initTimes_,endTimes_]=<a href="#_sub28" class="code" title="subfunction [numStrides,trials,initTimes,endTimes]=getStrideInfo(this,eventClass)">getStrideInfo</a>(this.data{t},eventClass);
0610                 numStrides=numStrides+numStrides_;
0611                 initTimes=[initTimes;initTimes_];
0612                 endTimes=[endTimes;endTimes_];
0613                 trials=[trials;t*ones(numStrides_,1)];
0614                 <span class="keyword">end</span>
0615             <span class="keyword">end</span>
0616         <span class="keyword">end</span>
0617     <span class="keyword">end</span>
0618     methods (Hidden=true, Access=private)
0619         <a name="_sub28" href="#_subfunctions" class="code">function adaptData=makeDataObjNew(this,filename,experimentalFlag,contraLateralFlag)</a>
0620             <span class="comment">%This function may not be compatible with certain methods of the</span>
0621             <span class="comment">%adaptationData class</span>
0622 
0623             <span class="keyword">if</span> isempty(contraLateralFlag) || contraLateralFlag==0 <span class="comment">%Normal parameters</span>
0624                 <span class="comment">%nop</span>
0625             <span class="keyword">else</span> <span class="comment">%Computing all parameters on a contraLateral way (this is, we compute parameters using the NON reference leg as the 'slow' one, opposite to the default computation)</span>
0626                 <span class="keyword">if</span> strcmp(this.getRefLeg,<span class="string">'R'</span>)
0627                     initEventSide=<span class="string">'L'</span>;
0628                 <span class="keyword">elseif</span> strcmp(this.getRefLeg,<span class="string">'L'</span>)
0629                     initEventSide=<span class="string">'R'</span>;
0630                 <span class="keyword">else</span>
0631                     ME=MException(<span class="string">'makeDataObject:ContralateralComputation'</span>,<span class="string">'Could not determine proper reference leg for this experiment.'</span>);
0632                     throw(ME);
0633                 <span class="keyword">end</span>
0634                 this=<a href="#_sub21" class="code" title="subfunction this=recomputeParameters(this,eventClass,initEventSide,parameterClasses)">recomputeParameters</a>(this,[],initEventSide); <span class="comment">%Using default event class ('', as opposed to 'force' or 'kin')</span>
0635             <span class="keyword">end</span>
0636 
0637             <span class="keyword">for</span> i=1:length(this.data) <span class="comment">%Trials</span>
0638                 <span class="keyword">if</span> ~isempty(this.data{i}) &amp;&amp; ~isempty(this.data{i}.adaptParams)
0639                     <span class="comment">%Get data from this trial:</span>
0640                     aux=this.data{i}.adaptParams;
0641                     trialTypes{i}=this.data{i}.metaData.type;
0642                     <span class="keyword">if</span> ~(nargin&gt;2 &amp;&amp; ~isempty(experimentalFlag) &amp;&amp; experimentalFlag==0)
0643                         aux=cat(aux,this.data{i}.experimentalParams);
0644                     <span class="keyword">end</span>
0645                     <span class="comment">%Concatenate with other trials:</span>
0646                     <span class="keyword">if</span> ~isempty(aux.Data) <span class="comment">%Case in which no strides were detected for a trial, it could happen. Not concatenating those</span>
0647                         <span class="keyword">if</span> ~exist(<span class="string">'paramData'</span>,<span class="string">'var'</span>)
0648                             paramData=aux;
0649                         <span class="keyword">else</span>
0650                             paramData=addStrides(paramData,aux);
0651                         <span class="keyword">end</span>
0652                     <span class="keyword">end</span>
0653                 <span class="keyword">end</span>
0654             <span class="keyword">end</span>
0655             <span class="comment">% HH: remove all bad strides completely</span>
0656             <span class="comment">% paramData=parameterSeries(paramData.Data(paramData.bad==0,:),paramData.labels,paramData.hiddenTime(paramData.bad==0),paramData.description);</span>
0657             paramData=paramData.setTrialTypes(trialTypes);
0658             adaptData=adaptationData(this.metaData,this.subData,paramData);
0659             <span class="keyword">if</span> nargin&gt;1 &amp;&amp; ~isempty(filename)
0660                 save([filename <span class="string">'params.mat'</span>],<span class="string">'adaptData'</span>,<span class="string">'-v7.3'</span>); <span class="comment">%HH edit 2/12 - added 'params' to file name so experimentData file isn't overwritten</span>
0661             <span class="keyword">end</span>
0662         <span class="keyword">end</span>
0663     <span class="keyword">end</span>
0664     methods (Static)
0665         <a name="_sub29" href="#_subfunctions" class="code">function this=loadobj(this)</a>
0666             <span class="keyword">if</span> ~isempty(this.subData.dateOfBirth)
0667                 warning(<span class="string">'expData:subjectDOB'</span>,[<span class="string">'Subject data contains DOB information for subject '</span> this.subData.ID <span class="string">'. Data will be hidden. You should overwrite (save) your file with this new version to prevent this warning in the future. Please check that all other information is intact before overwriting.'</span>])
0668                 <span class="comment">%Determine age (in months):</span>
0669                 age=round(this.metaData.date.timeSince(this.subData.dateOfBirth));
0670                 <span class="comment">%Scrub DOB from subject meta data, save age at experiment time (in years):</span>
0671                 this.subData=subjectData([],this.subData.sex,this.subData.dominantLeg,this.subData.dominantArm,this.subData.height,this.subData.weight,age/12,this.subData.ID);
0672             <span class="keyword">end</span>
0673         <span class="keyword">end</span>
0674     <span class="keyword">end</span>
0675 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Tue 16-Apr-2024 13:38:13 by <strong><a href="https://github.com/gllmflndn/m2html">m2html</a></strong> &copy; 2003-2022</address>
</body>
</html>